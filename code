=======================================
INICIO FICHERO >> ./makefile.dev
=======================================
# Makefile para desarrollo local de QA App

install:
	docker compose run --rm backend sh -c "npm install"
	docker compose run --rm frontend sh -c "npm install"
	docker compose run --rm dashboard sh -c "npm install"

dev: build install
	docker compose up -d
	docker compose logs -f

restart:
	@echo "ðŸ”„ Reiniciando contenedores sin reconstruir..."
	docker compose down
	docker compose up -d
	docker compose logs -f
    
build:
	docker compose build

stop:
	docker compose down

depack:
	python d.py code      

cleanAll:
	docker compose down -v --remove-orphans
	lsof -t -i tcp:3001 | xargs kill || true
	docker compose down --volumes
	rm -rf node_modules package-lock.json
	docker system prune -af --volumes

# ðŸš€ Nuevo comando: build + install + up + logs
dev-all:
	@echo "ðŸ”„ Construyendo imÃ¡genes y reinstalando dependencias..."
	docker compose build --no-cache
	docker compose run --rm backend sh -c "npm install"
	docker compose run --rm frontend sh -c "npm install"
	docker compose run --rm dashboard sh -c "npm install"
	@echo "ðŸš€ Levantando todos los servicios..."
	docker compose up -d
	@echo "ðŸ“œ Mostrando logs..."
	docker compose logs -f
 # âš¡ Arranque rÃ¡pido sin reconstruir imÃ¡genes
start:
	@echo "âš¡ Arranque rÃ¡pido con imÃ¡genes ya construidas..."
	docker compose up -d
	docker compose logs -f
=======================================
FIN FICHERO >> ./makefile.dev
=======================================
